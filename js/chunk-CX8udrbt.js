import{d as e,c as t,o as l,n as s,b as a,j as n,a as o,Q as u,g as i,h as c,ay as r,az as d,aA as p,aB as b,ac as m,y as f,z as h,r as x,aC as w,f as g,B as v,l as C,p as k,I as y,a6 as z,aD as U,i as P,Z as L,_ as D,aE as j,X as V,a4 as $,a5 as S,R as _}from"./chunk-DjcfpCfW.js";import{u as A,i as I,e as M}from"./chunk-KnS5xexs.js";import{_ as N}from"./chunk-DP1s4TDo.js";const B=["data-tip"],T=e({__name:"index",props:{tip:{},type:{default:"info"},direction:{default:"top"},size:{default:"sm"}},setup(e){const m=e,f={"2xs":"w-2 h-2",xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-7 h-7","2xl":"w-8 h-8"},h=a(()=>[`tooltip-${m.direction}`]),x=a(()=>[`w-${f[m.size]}`]);return(a,m)=>(l(),t("div",{class:s(["tooltip",h.value]),"data-tip":e.tip},[n(a.$slots,"content"),n(a.$slots,"default",{},()=>[o("div",{class:s([x.value,"hover:text-primary cursor-pointer"])},["warning"===e.type?(l(),u(c(r),{key:0,class:"w-full h-full text-warning"})):"info"===e.type?(l(),u(c(d),{key:1,class:"w-full h-full"})):"success"===e.type?(l(),u(c(p),{key:2,class:"w-full h-full text-success"})):"error"===e.type?(l(),u(c(b),{key:3,class:"w-full h-full text-error"})):i("",!0)],2)])],10,B))}});function H(){const e=m.useToast(),t=f.createInstance({name:"imgStore"}),l=A().prizeConfig,s=A().globalConfig,{getPrizeConfig:a,getCurrentPrize:n}=h(l),{getImageList:o}=h(s),u=x([]),i=x(w(a.value)),c=x();return g(()=>{!async function(){(await t.keys()).length>0&&t.iterate((e,t)=>{u.value.push({key:t,value:e})})}()}),v(()=>i.value,e=>{l.setPrizeConfig(e)},{deep:!0}),{addPrize:function(){const t={id:(new Date).getTime().toString(),name:I.global.t("data.prizeName"),sort:0,isAll:!1,count:1,isUsedCount:0,picture:{id:"",name:"",url:""},separateCount:{enable:!1,countList:[]},desc:"",isUsed:!1,isShow:!0,frequency:1};i.value.push(t),e.success(I.global.t("error.success"))},resetDefault:function(){l.resetDefault(),i.value=w(a.value),e.success(I.global.t("error.success"))},delAll:async function(){i.value=[],e.success(I.global.t("error.success"))},delItem:function(t){l.deletePrizeConfig(t.id),e.success(I.global.t("error.deleteSuccess"))},prizeList:i,currentPrize:n,selectedPrize:c,submitData:function(e){c.value.separateCount.countList=e,c.value=null},changePrizePerson:function(e){let t=-1;for(let l=0;l<i.value.length;l++)if(i.value[l].id===e.id){t=l;break}t>-1&&(i.value[t].separateCount.countList=[],i.value[t].isUsed?i.value[t].isUsedCount=i.value[t].count:i.value[t].isUsedCount=0)},changePrizeStatus:function(e){e.isUsed?e.isUsedCount=0:e.isUsedCount=e.count,e.separateCount.countList=[],e.isUsed=!e.isUsed},selectPrize:function(e){c.value=e,c.value.isUsedCount=0,c.value.isUsed=!1,c.value.separateCount.countList.length>1||(c.value.separateCount={enable:!0,countList:[{id:"0",count:e.count,isUsedCount:0}]})},localImageList:o}}const R={class:"flex w-full gap-3"},q={role:"alert",class:"w-full my-4 alert alert-info"},E={class:"flex items-center justify-center max-w-xs px-2 handle form-control"},Q={class:"w-1/2 max-w-xs form-control"},X={class:"label"},Z={class:"label-text"},F=["onUpdate:modelValue","placeholder"],G={class:"flex items-center w-1/2 max-w-xs gap-2 form-control"},J={class:"label"},K={class:"label-text"},O=["checked","onChange"],W={class:"w-1/2 max-w-2xl form-control"},Y={class:"label"},ee={class:"label-text"},te=["onUpdate:modelValue","placeholder","onChange"],le=["data-tip"],se=["value","max"],ae={class:"flex items-center w-1/2 max-w-xs gap-2 form-control"},ne={class:"label"},oe={class:"label-text"},ue=["checked","onChange"],ie={class:"w-full max-w-xs form-control"},ce={class:"label"},re={class:"label-text"},de=["onUpdate:modelValue"],pe={key:0,value:{id:"",name:"",url:""}},be={disabled:"",selected:""},me=["title","value"],fe={class:"truncate w-option-xs"},he={key:0,class:"w-full max-w-xs form-control"},xe={class:"label"},we={class:"label-text"},ge=["onClick"],ve={key:0,class:"flex flex-wrap w-full h-full gap-1 p-0 pt-1 m-0 cursor-pointer"},Ce=["data-tip"],ke={key:1,class:"btn btn-secondary btn-xs"},ye={class:"w-full max-w-xs form-control"},ze={class:"label"},Ue={class:"label-text"},Pe={class:"flex gap-2"},Le=["onClick"],De=e({__name:"PrizeConfig",setup(e){const{addPrize:a,resetDefault:n,delAll:u,delItem:r,prizeList:d,currentPrize:p,selectedPrize:b,submitData:m,changePrizePerson:f,changePrizeStatus:h,selectPrize:x,localImageList:w}=H(),{t:g}=C();return(e,v)=>(l(),t("div",null,[k(N,{title:c(g)("viewTitle.prizeManagement")},{buttons:y(()=>[o("div",R,[o("button",{class:"btn btn-info btn-sm",onClick:v[0]||(v[0]=(...e)=>c(a)&&c(a)(...e))},P(c(g)("button.add")),1),o("button",{class:"btn btn-info btn-sm",onClick:v[1]||(v[1]=(...e)=>c(n)&&c(n)(...e))},P(c(g)("button.resetDefault")),1),o("button",{class:"btn btn-error btn-sm",onClick:v[2]||(v[2]=(...e)=>c(u)&&c(u)(...e))},P(c(g)("button.allDelete")),1)])]),alerts:y(()=>[o("div",q,[v[4]||(v[4]=o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"w-6 h-6 stroke-current shrink-0"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),o("span",null,P(c(g)("dialog.tipResetPrize")),1)])]),_:1},8,["title"]),k(c(U),{modelValue:c(d),"onUpdate:modelValue":v[3]||(v[3]=e=>z(d)?d.value=e:null),animation:150,handle:".handle",class:"p-0 m-0"},{default:y(()=>[(l(!0),t(L,null,D(c(d),e=>(l(),t("div",{key:e.id,class:s(["flex items-center justify-center gap-10 py-5",c(p).id===e.id?"border border-dotted rounded-xl":null])},[o("label",E,[k(c(j),{class:"w-10 h-10 cursor-move handle"})]),o("label",Q,[o("div",X,[o("span",Z,P(c(g)("table.prizeName")),1)]),V(o("input",{"onUpdate:modelValue":t=>e.name=t,type:"text",placeholder:c(g)("placeHolder.name"),class:"w-full max-w-xs input-sm input input-bordered"},null,8,F),[[$,e.name]])]),o("label",G,[o("div",J,[o("span",K,P(c(g)("table.fullParticipation")),1)]),o("input",{type:"checkbox",checked:e.isAll,class:"border-solid checkbox checkbox-secondary border",onChange:t=>e.isAll=!e.isAll},null,40,O)]),o("label",W,[o("div",Y,[o("span",ee,P(c(g)("table.numberParticipants")),1)]),V(o("input",{"onUpdate:modelValue":t=>e.count=t,type:"number",placeholder:c(g)("placeHolder.winnerCount"),class:"w-full max-w-xs p-0 m-0 input-sm input input-bordered",onChange:t=>c(f)(e)},null,40,te),[[$,e.count]]),o("div",{class:"tooltip tooltip-bottom w-full","data-tip":`${c(g)("table.isDone")+e.isUsedCount}/${e.count}`},[o("progress",{class:"progress w-full",value:e.isUsedCount,max:e.count},null,8,se)],8,le)]),o("label",ae,[o("div",ne,[o("span",oe,P(c(g)("table.isDone")),1)]),o("input",{type:"checkbox",checked:e.isUsed,class:"border-solid checkbox checkbox-secondary border",onChange:t=>c(h)(e)},null,40,ue)]),o("label",ie,[o("div",ce,[o("span",re,P(c(g)("table.image")),1)]),V(o("select",{"onUpdate:modelValue":t=>e.picture=t,class:"truncate select select-warning select-sm"},[e.picture.id?(l(),t("option",pe,"âŒ")):i("",!0),o("option",be,P(c(g)("table.selectPicture")),1),(l(!0),t(L,null,D(c(w),e=>(l(),t("option",{key:e.id,title:e.name,class:"w-full max-w-full",value:e},[o("span",fe,P(e.name),1)],8,me))),128))],8,de),[[S,e.picture]])]),e.separateCount?(l(),t("label",he,[o("div",xe,[o("span",we,P(c(g)("table.onceNumber")),1),k(c(T),{tip:c(g)("tooltip.onceNumberMax")},null,8,["tip"])]),o("div",{class:"flex justify-start w-full h-full",onClick:t=>c(x)(e)},[e.separateCount.countList.length?(l(),t("ul",ve,[(l(!0),t(L,null,D(e.separateCount.countList,e=>(l(),t("li",{key:e.id,class:"relative flex items-center justify-center w-8 h-8 bg-slate-600/60 separated"},[o("div",{class:"flex items-center justify-center w-full h-full tooltip","data-tip":`${c(g)("tooltip.doneCount")+e.isUsedCount}/${e.count}`},[o("div",{class:"absolute left-0 z-50 h-full bg-blue-300/80",style:_(`width:${100*e.isUsedCount/e.count}%`)},null,4),o("span",null,P(e.count),1)],8,Ce)]))),128))])):(l(),t("button",ke,P(c(g)("button.setting")),1))],8,ge)])):i("",!0),o("label",ye,[o("div",ze,[o("span",Ue,P(c(g)("table.operation")),1)]),o("div",Pe,[o("button",{class:"btn btn-error btn-xs",onClick:t=>c(r)(e)},P(c(g)("button.delete")),9,Le)])])],2))),128))]),_:1},8,["modelValue"]),k(M,{"total-number":c(b)?.count,"separated-number":c(b)?.separateCount.countList,onSubmitData:c(m)},null,8,["total-number","separated-number","onSubmitData"])]))}});export{De as default};
